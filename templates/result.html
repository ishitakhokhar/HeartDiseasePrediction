{% extends "base.html" %}

{% block content %}

<div class="d-flex justify-content-center align-items-center" style="min-height: 70vh;">

    <div class="result-card">

        {% if risk == "high" %}
        <h3 class="text-danger result-text">
            ðŸ”´ Heart Disease Detected
        </h3>
        <p>
            Based on the provided health details, the model predicts a
            <strong>high risk of heart disease</strong>.
        </p>
        {% set voice_message =
        "Based on the analysis, there is a high risk of heart disease. Please consult a medical professional."
        %}
        {% else %}
        <h3 class="text-success result-text">
            ðŸŸ¢ No Risk of Heart Disease
        </h3>
        <p>
            Based on the provided health details, the model predicts
            <strong>no significant risk of heart disease</strong>.
        </p>
        {% set voice_message =
        "Based on the analysis, there is no significant risk of heart disease."
        %}
        {% endif %}

        <p class="mt-3">
            Prediction Confidence:
            <strong>{{ probability }}%</strong>
        </p>

        <a href="/" class="btn-back mt-4 d-inline-block">
            Back to Home
        </a>

    </div>
</div>

<!-- Doctor Voice Script -->
<script>
    const message = "{{ voice_message }}";

    function speakDoctorVoice(text) {
        const synth = window.speechSynthesis;
        const utter = new SpeechSynthesisUtterance(text);

        utter.pitch = 0.8;   // calm tone
        utter.rate = 0.85;   // slow & clear
        utter.volume = 1;

        const voices = synth.getVoices();
        const preferredVoices = [
            "Google UK English Female",
            "Google US English",
            "Microsoft Zira Desktop",
            "Microsoft David Desktop",
            "Google English"
        ];

        for (const v of voices) {
            if (preferredVoices.includes(v.name)) {
                utter.voice = v;
                break;
            }
        }

        synth.speak(utter);
    }

    window.onload = () => {
        speakDoctorVoice(message);
    };
</script>

{% endblock %}